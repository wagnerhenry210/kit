"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[74807],{374807:function(t,e,a){a.d(e,{e_:function(){return b},c6:function(){return f},h$:function(){return p},iK:function(){return w}});var o=a(296638),n=a(251743),i=a(294541),s=a(2170),r=a(136818),d=a(73796),u=a(739946),c=a(115633),l=a(777717);let g={bandwidth:["bandwidth_outgoing_bytes","bandwidth_incoming_bytes"],requests:["request_hit_count","request_miss_count"],invocations:["function_invocation_successful_count","function_invocation_error_count","function_invocation_timeout_count"],edgeFunctionExecutionUnits:["edge_function_execution_units"],execution:["function_execution_successful_gb_hours","function_execution_error_gb_hours","function_execution_timeout_gb_hours"],workerInvocations:["worker_invocation_count"],throttles:["function_invocation_throttle_count"],buildTime:["build_build_seconds","build_queued_seconds"],buildNumber:["build_completed_count","build_failed_count"],images:["images_sources_count"],artifactsTaskDuration:["artifacts_downloaded_task_duration_ms","artifacts_local_cache_hit_task_duration_ms"],artifactsSize:["artifacts_downloaded_size_bytes","artifacts_uploaded_size_bytes"],artifactsCount:["artifacts_downloaded_count","artifacts_uploaded_count"],monitoring:["monitoring_metric_count"],edgeConfigReads:["edge_config_reads"],edgeConfigWrites:["edge_config_writes"],postgresComputeTime:["postgres_compute_seconds"],postgresDataTransfer:["postgres_transfer_bytes"],postgresWrittenData:["postgres_written_bytes"],storageRedisTotalCommands:["redis_commands"],storageRedisTotalBandwidthInBytes:["redis_bandwidth_max_bytes"],storageRedisTotalDailyAvgStorageInBytes:["redis_storage_max_avg_bytes"],storageRedisTotalDatabases:["redis_databases"],cronJobInvocations:["cron_job_invocations"],dataCacheBandwidth:["data_cache_total_received_bytes","data_cache_total_sent_bytes"]},_={workerExecutionAvg:["worker_execution_time_avg"]},m={bandwidth:"bandwidth",requests:"requests",invocations:"function_invocations",execution:"function_execution",throttles:"function_throttle_count",workerExecutionAvg:"worker_execution_time_avg",workerInvocations:"worker_invocations",buildTime:"build_time",buildNumber:"build_count",images:"image_sources",artifactsSize:"artifacts_size_breakdown",artifactsCount:"artifacts_count_breakdown",artifactsTaskDuration:"artifacts_time_breakdown",monitoring:"monitoring",edgeConfigReads:"edge_config_reads",edgeConfigWrites:"edge_config_writes",postgresComputeTime:"postgres_compute_seconds",postgresDataTransfer:"postgres_transfer_bytes",postgresWrittenData:"postgres_written_bytes",storageRedisTotalCommands:"redis_commands",storageRedisTotalBandwidthInBytes:"redis_bandwidth_max_bytes",storageRedisTotalDailyAvgStorageInBytes:"redis_storage_max_avg_bytes",storageRedisTotalDatabases:"redis_databases",cronJobInvocations:"cron_job_invocations",dataCacheBandwidth:"data_cache_bandwidth"};function f(t){let{projectId:e,start:a,end:s}=t,{isReady:r,team:u}=(0,l.t7)();return(0,o.ZP)(()=>r&&a&&s&&void 0!==e?`${d.oJ}${(0,i.c)({teamId:null==u?void 0:u.id,projectId:e,from:"object"==typeof a?a.toISOString():new Date(a).toISOString(),to:"object"==typeof s?s.toISOString():new Date(s).toISOString()})}`:null,async t=>{let e=await (0,n.I)(t,{throwOnHTTPError:!0});return function(t){let{data:e,from:a,to:o}=t,n=e.analytics.data,i={analytics:Date.now()},s=[];for(let t=0;t<n.length;t++){let e=n[t];s.push({date:new Date(e.date).getTime(),sum:e.report_count,0:e.report_count,1:0,2:0})}let r={from:new Date(a),to:new Date(o),granularity:e.analytics.granularity,analytics:s,change:{},lastUpdate:i,started:{analytics:"2021-01-01T00:00:00.000Z"},insight:{analytics:[]}};return r}({from:a,to:s,data:e})},{revalidateOnFocus:!1,revalidateOnReconnect:!1,refreshInterval:0})}let T=t=>({revalidateOnFocus:!1,revalidateOnReconnect:!1,refreshInterval:0,onError:(e,a)=>{let o=e.statusCode||e.status,n=404!==o&&403!==o&&"cancelled"!==e.message&&!(0,u.I)()&&"pending"!==e.message;n&&(console.table(e),(0,s.Op)(a,t),console.error(e))},onSuccess:(e,a)=>{(0,s.M9)(a,t)},onErrorRetry:(t,e,a,o,n)=>{let{retryCount:i}=n;if("pending"===t.message)return setTimeout(o,3e3);(0,r.h)(t,e,a,o,{retryCount:i})}});function w(t){let{type:e,projectId:a=null,storeId:s=null,functionName:r=null,edgeConfigId:u=null,edgeInvocationType:f=null,sourceName:w=null,skip:p=!1,granularity:b,start:v,end:h}=t,{isReady:y,team:D}=(0,l.t7)(),I=(0,c.e1)();return(0,o.ZP)(()=>y&&v&&h&&!p&&void 0!==a&&void 0!==r?`${d.Pm}${(0,i.c)({type:e,teamId:null==D?void 0:D.id,projectId:a,storeId:s,edgeConfigId:u,functionName:r,edgeInvocationType:f,sourceName:w,granularity:b,from:"object"==typeof v?v.toISOString():new Date(v).toISOString(),to:"object"==typeof h?h.toISOString():new Date(h).toISOString()})}`:null,async t=>{let a=await (0,n.I)(t,{throwOnHTTPError:!0});return function(t){var e,a,o,n,i;let{data:s,from:r,to:d,team:u,queryContext:c}=t;if("pending"in s)throw Error("pending");let l=[];if(s.data.length)for(let t=0;t<s.data.length;t++)l.push(s.data[t]);let f={workerExecutionAvg:"2022-05-24T00:00:00.000Z"},T={bandwidth:"2021-01-26T00:00:09.000Z",requests:"2021-01-26T00:00:09.000Z",invocations:"2021-02-16T00:00:00.000Z",edgeFunctionExecutionUnits:"2021-02-16T00:00:00.000Z",execution:"2021-02-16T00:00:00.000Z",workerInvocations:"2021-10-22T00:00:00.000Z",throttles:"2021-02-16T00:00:00.000Z",buildTime:"2021-02-19T00:00:00.000Z",buildNumber:"2021-02-19T00:00:00.000Z",images:"2021-07-01T00:00:00.000Z",artifactsTaskDuration:"2021-12-14T00:00:00.000Z",artifactsSize:"2021-12-14T00:00:00.000Z",artifactsCount:"2021-12-14T00:00:00.000Z",monitoring:"2023-03-06T00:00:00.000Z",edgeConfigReads:"2023-03-14T00:00:00.000Z",edgeConfigWrites:"2023-03-14T00:00:00.000Z",postgresComputeTime:"2023-04-01T00:00:00.000Z",postgresDataTransfer:"2023-04-01T00:00:00.000Z",postgresWrittenData:"2023-04-01T00:00:00.000Z",storageRedisTotalCommands:"2023-04-01T00:00:00.000Z",storageRedisTotalBandwidthInBytes:"2023-04-01T00:00:00.000Z",storageRedisTotalDailyAvgStorageInBytes:"2023-04-01T00:00:00.000Z",storageRedisTotalDatabases:"2023-04-01T00:00:00.000Z",cronJobInvocations:"2023-04-01T00:00:00.000Z",dataCacheBandwidth:"2023-05-01T00:00:00.000Z",...f},w={edge:new Date(s.lastUpdate).getTime(),builds:new Date(s.lastUpdate).getTime(),images:new Date(s.lastUpdate).getTime(),artifacts:new Date(s.lastUpdate).getTime(),monitoring:new Date(s.lastUpdate).getTime(),edgeConfigReads:new Date(s.lastUpdate).getTime(),edgeConfigWrites:new Date(s.lastUpdate).getTime(),postgresComputeTime:new Date(s.lastUpdate).getTime(),postgresDataTransfer:new Date(s.lastUpdate).getTime(),postgresWrittenData:new Date(s.lastUpdate).getTime(),storageRedisTotalCommands:new Date(s.lastUpdate).getTime(),storageRedisTotalBandwidthInBytes:new Date(s.lastUpdate).getTime(),storageRedisTotalDailyAvgStorageInBytes:new Date(s.lastUpdate).getTime(),storageRedisTotalDatabases:new Date(s.lastUpdate).getTime(),cronJobInvocations:new Date(s.lastUpdate).getTime(),dataCacheBandwidth:new Date(s.lastUpdate).getTime()},p={bandwidth:[],requests:[],invocations:[],edgeFunctionExecutionUnits:[],execution:[],workerInvocations:[],workerExecutionAvg:[],throttles:[],buildTime:[],buildNumber:[],images:[],artifactsTaskDuration:[],artifactsSize:[],artifactsCount:[],monitoring:[],edgeConfigReads:[],edgeConfigWrites:[],postgresComputeTime:[],postgresDataTransfer:[],postgresWrittenData:[],storageRedisTotalCommands:[],storageRedisTotalBandwidthInBytes:[],storageRedisTotalDailyAvgStorageInBytes:[],storageRedisTotalDatabases:[],cronJobInvocations:[],dataCacheBandwidth:[]},b={bandwidth:[],requests:[],invocations:[],edgeFunctionExecutionUnits:[],execution:[],workerInvocations:[],throttles:[],buildTime:[],buildNumber:[],images:[],artifactsSize:[],artifactsTaskDuration:[],artifactsCount:[],monitoring:[],edgeConfigReads:[],edgeConfigWrites:[],postgresComputeTime:[],postgresDataTransfer:[],postgresWrittenData:[],storageRedisTotalCommands:[],storageRedisTotalBandwidthInBytes:[],storageRedisTotalDailyAvgStorageInBytes:[],storageRedisTotalDatabases:[],cronJobInvocations:[],dataCacheBandwidth:[]},v={workerExecutionAvg:[]},h={},y={};for(let t=0;t<l.length;t++){let e=l[t];for(let t in g){let a=t,o=new Date(e.first_event).getTime(),n={date:new Date(e.date).getTime(),sum:0,0:0,1:0,2:0};if((o||n.date)<Date.parse(T[a]))continue;let i=0;for(let t=0;t<g[a].length;t++){let o=t;n[o]=e[g[a][t]]||0,n.sum+=n[o],e.previous&&(i+=n[o],i-=e.previous[g[a][t]]??0),y[a]=y[a]??{},y[a][t]=(y[a][t]??0)+n[o]}b[a].push(n),h[a]=(h[a]||0)+i}for(let t in _){let a=t,o={date:new Date(e.date).getTime(),0:[0,0],1:[0,0],2:[0,0]};for(let t=0;t<_[a].length;t++){let n=o.date>=Date.parse(f[a]);o[t]=(n?e[_[a][t]]:void 0)||[0,0]}v[a].push(o)}}let D="number"==typeof r?r:r.getTime(),I="number"==typeof d?d:d.getTime(),C=D-(I-D);for(let t in g){let e=t;new Date(T[e]).getTime()>C&&delete h[e]}if(u&&(null===(e=y.buildTime)||void 0===e?void 0:e[1])&&Math.round(y.buildTime[1]/3600)>=1&&p.buildTime.push({type:"tooManySecondsQueued",secondsQueued:y.buildTime[1],teamSlug:u.slug,warning:!0}),(null===(a=y.invocations)||void 0===a?void 0:a[1])&&y.invocations[1]>=1&&p.invocations.push({type:"tooManyInvocationErrors",errorCount:y.invocations[1],warning:!0}),(null===(o=y.execution)||void 0===o?void 0:o[1])&&y.execution[1]>=.01&&p.execution.push({type:"tooManyExecutionErrors",errorTime:y.execution[1],warning:!0}),(null===(n=y.images)||void 0===n?void 0:n[0])?(!u||(null===(i=u.billing)||void 0===i?void 0:i.plan)==="hobby")&&y.images[0]>1e3&&p.images.push({type:"aboveImagesFairUseLimit",optimizedImages:y.images[0],warning:!0}):p.images.push({type:"noImageData",warning:!0}),!u&&"edge"===c.type&&"middleware"===c.edgeInvocationType){let t={sum:0,count:0};for(let e of v.workerExecutionAvg){let{date:a,breakdown:o,...n}=e;for(let[e,a]of Object.values(n))t.sum+=e,t.count+=a}t.sum/t.count>5e4&&p.workerExecutionAvg.push({type:"aboveEdgeMiddlewareCpuTimeFairUseLimit",warning:!0})}let S=Object.entries(m),k=Object.entries({...b,...v});S.forEach(t=>{let[e,a]=t;k.forEach(t=>{let[o,n]=t;if(o===e){let t=s.data.length-n.length;for(let e=0;e<s.data.slice(t).length;e++){let t=s.data[e].breakdown,o=t[a];t&&o&&(n[e].breakdown=o)}}})});let x={from:new Date(r),to:new Date(d),granularity:s.granularity,change:h,started:T,lastUpdate:w,insight:p,...b,...v};return x}({data:a,from:v,to:h,team:D,queryContext:{type:e,edgeInvocationType:f}})},T(I))}function p(t){let{type:e,skip:a=!1,start:s,end:r,edgeInvocationType:u}=t,{isReady:g,team:_}=(0,l.t7)(),m=(0,c.e1)();return(0,o.ZP)(()=>g&&s&&r&&!a?`${d.Pm}${(0,i.c)({type:e,edgeInvocationType:u,teamId:null==_?void 0:_.id,from:"object"==typeof s?s.toISOString():new Date(s).toISOString(),to:"object"==typeof r?r.toISOString():new Date(r).toISOString()})}`:null,async t=>{let e=await (0,n.I)(t);return function(t,e,a){let o={workerExecutionAvg:[]};for(let e of t.data){let t=new Date(e.date).getTime();o.workerExecutionAvg.push({date:t,data:e.worker_execution_time_avg})}return{from:new Date(e),to:new Date(a),granularity:t.granularity,lastUpdate:new Date(t.lastUpdate).getTime(),data:o}}(e,s,r)},T(m))}function b(t){let{isReady:e,team:a}=(0,l.t7)();return(0,o.ZP)(()=>!e||(null==t?void 0:t.skip)?null:`${d.Pm}${(0,i.c)({teamId:null==a?void 0:a.id,cycles:"1"})}`,t=>(0,n.I)(t,{throwOnHTTPError:!0}))}}}]);